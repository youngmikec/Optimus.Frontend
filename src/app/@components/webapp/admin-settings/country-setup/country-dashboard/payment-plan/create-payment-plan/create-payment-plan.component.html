<section id="manage-contact-category">
  <div class="manage-contact-category-header">
    <div>
      <h6 class="opt-heading-6 fw-600 mb-0">
        <ng-container *ngIf="data.type === 'edit'">Edit</ng-container>
        <ng-container *ngIf="data.type === 'create'">Create</ng-container>
        Payment Plan
      </h6>
    </div>
    <div matRipple class="close-icon-container" (click)="closeDialog()">
      <img src="/assets/icons/modal-close-icon.svg" alt="modal close icon" />
    </div>
  </div>

  <form [formGroup]="createPaymentPlanForm" (ngSubmit)="onSubmit()">
    <div class="input-style1 input-width mb-1">
      <label class="input-label">Country</label>
      <mat-form-field appearance="outline" [style.width.%]="100">
        <mat-select formControlName="countryId">
          <mat-option [value]="country.id" *ngFor="let country of countryList">
            {{ country.name }}
          </mat-option>
        </mat-select>

        <mat-error *ngIf="createPaymentPlansFormControls['countryId'].invalid">
          <img
            src="/assets/icons/error.svg"
            alt=""
            class="img-fluid error-icon"
          />
          {{ getErrorMessage('countryId') }}
        </mat-error>
      </mat-form-field>
    </div>

    <div class="input-style1 input-width mb-1">
      <label class="input-label">Select Migration Route.</label>
      <mat-form-field appearance="outline" [style.width.%]="100">
        <mat-select formControlName="migrationRouteId">
          <mat-option
            [value]="route.id"
            *ngFor="let route of migrationRouteList"
          >
            {{ route.name }}
          </mat-option>
        </mat-select>

        <mat-error
          *ngIf="createPaymentPlansFormControls['migrationRouteId'].invalid"
        >
          <img
            src="/assets/icons/error.svg"
            alt=""
            class="img-fluid error-icon"
          />
          {{ getErrorMessage('migrationRouteId') }}
        </mat-error>
      </mat-form-field>
    </div>

    <div class="input-style1 input-width mb-1">
      <label class="input-label">Payment Plan Name</label>
      <mat-form-field appearance="outline" [style.width.%]="100">
        <input
          formControlName="name"
          matInput
          placeholder="Enter payment plan name"
        />
        <mat-error *ngIf="createPaymentPlansFormControls['name'].invalid">
          <img
            src="/assets/icons/error.svg"
            alt=""
            class="img-fluid error-icon"
          />
          {{ getErrorMessage('name') }}
        </mat-error>
      </mat-form-field>
    </div>

    <div class="row">
      <div class="col-md-4">
        <div class="input-style1 input-width mb-1">
          <label class="input-label">Percentage (%)</label>
          <mat-form-field appearance="outline" [style.width.%]="100">
            <input
              type="number"
              formControlName="percentage"
              matInput
              placeholder=""
            />
            <mat-error
              *ngIf="createPaymentPlansFormControls['percentage'].invalid"
            >
              <img
                src="/assets/icons/error.svg"
                alt=""
                class="img-fluid error-icon"
              />
              {{ getErrorMessage('percentage') }}
            </mat-error>
          </mat-form-field>
        </div>
      </div>

      <div class="col-md-4">
        <div class="input-style1 input-width mb-1">
          <label class="input-label">Serial Number</label>
          <mat-form-field appearance="outline" [style.width.%]="100">
            <input
              type="number"
              formControlName="serialNumber"
              matInput
              placeholder=""
            />
            <mat-error
              *ngIf="createPaymentPlansFormControls['serialNumber'].invalid"
            >
              <img
                src="/assets/icons/error.svg"
                alt=""
                class="img-fluid error-icon"
              />
              {{ getErrorMessage('serialNumber') }}
            </mat-error>
          </mat-form-field>
        </div>
      </div>

      <div class="col-md-4">
        <div class="input-style1 input-width mb-1">
          <label class="input-label">Number of Installment</label>
          <mat-form-field appearance="outline" [style.width.%]="100">
            <input
              type="number"
              formControlName="numberOfInstallment"
              matInput
              placeholder="Installment"
            />
            <mat-error
              *ngIf="
                createPaymentPlansFormControls['numberOfInstallment'].invalid
              "
            >
              <img
                src="/assets/icons/error.svg"
                alt=""
                class="img-fluid error-icon"
              />
              {{ getErrorMessage('numberOfInstallment') }}
            </mat-error>
          </mat-form-field>
        </div>
      </div>

      <div class="col-md-4">
        <div class="input-style1 input-width mb-1">
          <label class="input-label">Duration</label>

          <mat-form-field appearance="outline" [style.width.%]="100">
            <input
              type="number"
              formControlName="duration"
              matInput
              placeholder="Duration (in month)"
            />
            <mat-error
              *ngIf="createPaymentPlansFormControls['duration'].invalid"
            >
              <img
                src="/assets/icons/error.svg"
                alt=""
                class="img-fluid error-icon"
              />
              {{ getErrorMessage('duration') }}
            </mat-error>
          </mat-form-field>
        </div>
      </div>

      <div class="col-md-4">
        <div class="input-style1 input-width mb-1">
          <label class="input-label">Interest Rate</label>

          <mat-form-field appearance="outline" [style.width.%]="100">
            <input
              type="number"
              formControlName="interestRate"
              matInput
              placeholder="Interest Rate"
            />
            <mat-error
              *ngIf="createPaymentPlansFormControls['interestRate'].invalid"
            >
              <img
                src="/assets/icons/error.svg"
                alt=""
                class="img-fluid error-icon"
              />
              {{ getErrorMessage('interestRate') }}
            </mat-error>
          </mat-form-field>
        </div>
      </div>

      <div class="col-md-4">
        <div class="input-style1 input-width mb-1">
          <label class="input-label">Down Payment</label>

          <mat-form-field appearance="outline" [style.width.%]="100">
            <input
              type="number"
              formControlName="downPayment"
              matInput
              placeholder="Down Payment"
            />
            <mat-error
              *ngIf="createPaymentPlansFormControls['downPayment'].invalid"
            >
              <img
                src="/assets/icons/error.svg"
                alt=""
                class="img-fluid error-icon"
              />
              {{ getErrorMessage('downPayment') }}
            </mat-error>
          </mat-form-field>
        </div>
      </div>
    </div>

    <div class="row mb-1">
      <div class="col-md-6">
        <div class="input-style1 mb-2">
          <label class="input-label input-required">Fee Category</label>

          <div>
            <mat-radio-group
              class="opt-radio-group"
              formControlName="feeCategory"
            >
              <mat-radio-button
                [value]="item.value"
                class="opt-radio-btn"
                *ngFor="let item of feeCategoryList"
              >
                <span class="mat-radio-label-content">{{ item.name }}</span>
              </mat-radio-button>
            </mat-radio-group>
          </div>
        </div>
      </div>
    </div>

    <div class="cta-container">
      <button
        matRipple
        type="button"
        class="btn opt-btn-primary-outline"
        (click)="closeDialog()"
      >
        Cancel
      </button>

      <button
        matRipple
        class="btn opt-btn-primary"
        [disabled]="
          createPaymentPlanForm.invalid || (isLoading | async) !== false
        "
      >
        <ng-container *ngIf="data.type === 'edit'">Save</ng-container>
        <ng-container *ngIf="data.type === 'create'">Create</ng-container>
        <ng-container *ngIf="(isLoading | async) !== false">
          <app-button-loader></app-button-loader>
        </ng-container>
      </button>
    </div>
  </form>
</section>
