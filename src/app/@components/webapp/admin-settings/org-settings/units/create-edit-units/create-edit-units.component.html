<section id="manage-department">
  <div class="manage-department-header">
    <div class="text-content">
      <div class="d-flex align-items-center justify-content-between">
        <h6 class="opt-para-2 fw-700 mb-0">
          <ng-container *ngIf="data?.instance !== 'update'">
            Create Unit
          </ng-container>
          <ng-container *ngIf="data?.instance === 'update'"
            >Edit Unit</ng-container
          >
        </h6>

        <!-- <div matRipple class="close-icon-container" (click)="closeDialog()">
            <img
              src="/assets/icons/modal-close-icon.svg"
              alt="modal close icon"
            />
          </div> -->
      </div>
      <!-- <p class="opt-caption">Lorem ipsum dolor sit amet consectetur.</p> -->
    </div>

    <div matRipple class="close-icon-container" (click)="closeDialog()">
      <img src="/assets/icons/modal-close-icon.svg" alt="modal close icon" />
    </div>
  </div>

  <form [formGroup]="manageUnitForm" (ngSubmit)="onSubmit()">
    <div class="input-style1 mb-3">
      <label class="input-label">Unit Name</label>

      <mat-form-field appearance="outline" [style.width.%]="100">
        <input matInput formControlName="name" placeholder="Enter Unit Name" />

        <mat-error *ngIf="manageUnitFormControls['name'].invalid">
          <img
            src="/assets/icons/error.svg"
            alt=""
            class="img-fluid error-icon"
          />

          {{ getErrorMessage('name') }}
        </mat-error>
      </mat-form-field>
    </div>

    <div class="input-style1 mb-3">
      <label class="input-label">Division</label>

      <mat-form-field appearance="outline" [style.width.%]="100">
        <mat-select
          formControlName="divisionId"
          placeholder="Select a Division"
          (selectionChange)="getDepartmentByDivisionId($event)"
        >
          <ng-container
            *ngIf="
              divisions !== null && divisions?.length !== 0;
              else noDivision
            "
          >
            <ng-container *ngFor="let division of divisions?.entity">
              <mat-option [value]="division.id">
                {{ division.name }}
              </mat-option>
            </ng-container>
          </ng-container>

          <ng-template #noDivision>
            <ng-container *ngIf="divisions === null">
              <mat-option disabled>Loading divisions...</mat-option>
            </ng-container>

            <ng-container *ngIf="divisions?.length === 0">
              <mat-option disabled>No division is available</mat-option>
            </ng-container>
          </ng-template>
        </mat-select>

        <mat-error *ngIf="manageUnitFormControls['divisionId'].invalid">
          <img
            src="/assets/icons/error.svg"
            alt=""
            class="img-fluid error-icon"
          />
          {{ getErrorMessage('divisionId') }}
        </mat-error>
      </mat-form-field>
    </div>

    <!-- <div class="input-style1 mb-3">
      <label class="input-label">Department</label>

      <mat-form-field appearance="outline" [style.width.%]="100">
        <mat-select
          formControlName="departmentId"
          placeholder="Select a Department"
          (selectionChange)="getDivisionByDepartmentId($event)"
        >
          <ng-container
            *ngIf="
              departments !== null && departments?.length !== 0;
              else noDepartment
            "
          >
            <ng-container *ngFor="let department of departments.entity">
              <mat-option [value]="department.id">
                {{ department.name }}
              </mat-option>
            </ng-container>
          </ng-container>

          <ng-template #noDepartment>
            <ng-container *ngIf="departments === null">
              <mat-option disabled>Loading departments...</mat-option>
            </ng-container>

            <ng-container *ngIf="departments?.length === 0">
              <mat-option disabled>No department is available</mat-option>
            </ng-container>
          </ng-template>
        </mat-select>

        <mat-error *ngIf="manageUnitFormControls['departmentId'].invalid">
          <img
            src="/assets/icons/error.svg"
            alt=""
            class="img-fluid error-icon"
          />
          {{ getErrorMessage('departmentId') }}
        </mat-error>
      </mat-form-field>
    </div> -->

    <div class="input-style1 mb-3">
      <label class="input-label">Department</label>

      <mat-form-field appearance="outline" [style.width.%]="100">
        <mat-select
          formControlName="departmentId"
          placeholder="Please select a department"
        >
          <ng-container
            *ngIf="
              departments !== null && departments?.length !== 0;
              else noDepartment
            "
          >
            <ng-container *ngFor="let department of departments.entity">
              <mat-option [value]="department.id">
                {{ department.name }}
              </mat-option>
            </ng-container>
          </ng-container>

          <ng-template #noDepartment>
            <ng-container *ngIf="departments === null">
              <mat-option disabled>Loading departments...</mat-option>
            </ng-container>

            <ng-container *ngIf="departments?.length === 0">
              <mat-option disabled>No department is available</mat-option>
            </ng-container>
          </ng-template>
        </mat-select>

        <mat-error *ngIf="manageUnitFormControls['departmentId'].invalid">
          <img
            src="/assets/icons/error.svg"
            alt=""
            class="img-fluid error-icon"
          />
          {{ getErrorMessage('departmentId') }}
        </mat-error>
      </mat-form-field>
    </div>

    <!-- <div class="input-style1 mb-3">
      <label class="input-label">Division</label>

      <mat-form-field appearance="outline" [style.width.%]="100">
        <mat-select
          formControlName="divisionId"
          placeholder="Please select a division"
        >
          <ng-container
            *ngIf="
              divisions !== null && divisions?.length !== 0;
              else noDivision
            "
          >
            <ng-container *ngFor="let division of divisions">
              <mat-option [value]="division.id">
                {{ division.name }}
              </mat-option>
            </ng-container>
          </ng-container>

          <ng-template #noDivision>
            <ng-container *ngIf="divisions === null">
              <mat-option disabled>Loading divisions...</mat-option>
            </ng-container>

            <ng-container *ngIf="divisions?.length === 0">
              <mat-option disabled>No division is available</mat-option>
            </ng-container>
          </ng-template>
        </mat-select>

        <mat-error *ngIf="manageUnitFormControls['divisionId'].invalid">
          <img
            src="/assets/icons/error.svg"
            alt=""
            class="img-fluid error-icon"
          />
          {{ getErrorMessage('divisionId') }}
        </mat-error>
      </mat-form-field>
    </div> -->

    <div class="btn-group">
      <div>
        <button
          type="button"
          matRipple
          class="btn opt-btn-primary-outline opt-btn-md"
          (click)="closeDialog()"
        >
          Cancel
        </button>
      </div>

      <div>
        <button
          type="submit"
          matRipple
          class="btn opt-btn-primary opt-btn-md"
          [disabled]="manageUnitForm.invalid || (isLoading | async) !== false"
        >
          <ng-container *ngIf="data?.instance === 'create'">
            Create
          </ng-container>

          <ng-container *ngIf="data?.instance === 'update'">
            Update
          </ng-container>

          <ng-container *ngIf="(isLoading | async) !== false">
            <app-button-loader></app-button-loader>
          </ng-container>
        </button>
      </div>
    </div>
  </form>
</section>
