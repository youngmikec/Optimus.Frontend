<section id="dashboard">
  <div class="dashboard_header">
    <div>
      <h6 class="fw-700">Good afternoon, {{ user?.FirstName }}!</h6>

      <p class="opt-para-1">Here is an overview of your applicants.</p>
    </div>

    <div class="table-controls">
      <button
        (click)="onCreateApplicant('create', null)"
        matRipple
        class="btn opt-btn-primary"
      >
        Create Applicant
      </button>

      <!-- <button matRipple class="btn opt-btn-neutral opt-btn-with-icon">
        <span class="img-fluid"><img src="assets/icons/calendar.svg" /></span>
      </button> -->
    </div>
  </div>

  <div class="wrapper">
    <div class="wrapper_grid">
      <div class="grid_one">
        <div class="cards-section">
          <div class="stat-card">
            <div class="stat-card-icon">
              <svg
                width="43"
                height="40"
                viewBox="0 0 43 40"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <ellipse
                  cx="21.5096"
                  cy="20"
                  rx="20.6496"
                  ry="20"
                  fill="#C3D2FE"
                />
                <ellipse
                  cx="21.5093"
                  cy="20"
                  rx="16.5197"
                  ry="16"
                  fill="#0235CD"
                />
                <g clip-path="url(#clip0_3446_103168)">
                  <path
                    d="M17.1822 13.627V11H17.1817L14.4699 13.6264V13.627H17.1822Z"
                    fill="white"
                  />
                  <path
                    d="M17.3279 19.3555H19.808V23.9024H17.3279V19.3555Z"
                    fill="white"
                  />
                  <path
                    d="M18.914 11C18.559 11 18.2711 11.2878 18.2711 11.6429V14.0388C18.2711 14.3939 17.9833 14.6817 17.6283 14.6817H15.1128C14.7578 14.6817 14.4699 14.9695 14.4699 15.3245V28.3571C14.4699 28.7122 14.7578 29 15.1128 29H27.9055C28.2606 29 28.5484 28.7122 28.5484 28.3571V11.6429C28.5484 11.2878 28.2606 11 27.9055 11H18.914ZM20.8969 24.3152C20.8969 24.6702 20.6091 24.958 20.2541 24.958H16.8818C16.5267 24.958 16.2389 24.6702 16.2389 24.3152V18.9446C16.2389 18.5895 16.5267 18.3017 16.8818 18.3017H20.2541C20.6091 18.3017 20.8969 18.5895 20.8969 18.9446V24.3152ZM26.8133 24.4307C26.8133 24.722 26.5772 24.958 26.2859 24.958H22.6149C22.3236 24.958 22.0875 24.722 22.0875 24.4307C22.0875 24.1395 22.3236 23.9034 22.6149 23.9034H26.2859C26.5772 23.9034 26.8133 24.1395 26.8133 24.4307ZM26.8133 22.1901C26.8133 22.4813 26.5772 22.7174 26.2859 22.7174H22.6149C22.3236 22.7174 22.0875 22.4813 22.0875 22.1901C22.0875 21.8988 22.3236 21.6627 22.6149 21.6627H26.2859C26.5772 21.6627 26.8133 21.8988 26.8133 22.1901ZM26.8133 19.9494C26.8133 20.2407 26.5772 20.4768 26.2859 20.4768H22.6149C22.3236 20.4768 22.0875 20.2407 22.0875 19.9494C22.0875 19.6582 22.3236 19.4221 22.6149 19.4221H26.2859C26.5772 19.4221 26.8133 19.6582 26.8133 19.9494Z"
                    fill="white"
                  />
                </g>
                <defs>
                  <clipPath id="clip0_3446_103168">
                    <rect
                      width="18.5846"
                      height="18"
                      fill="white"
                      transform="translate(12.2169 11)"
                    />
                  </clipPath>
                </defs>
              </svg>
            </div>
            <div class="stat-card-content">
              <p class="opt-para-1">Applicants</p>

              <div
                class="d-flex justify-content-between mb-2 align-items-center"
              >
                <h4 class="opt-heading-4 fw-700 mb-0 me-3">
                  {{ applicantDashboardData?.applicantsCount | number }}
                </h4>
                <div>
                  <!-- <div class="d-flex align-items-center country-percent">
                    <p class="opt-footer fw-600 me-1 mb-0">+2%</p>
                    <svg
                      width="11"
                      height="8"
                      viewBox="0 0 11 8"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M10 1.5L5.8 5.7L4.2 3.3L1 6.5"
                        stroke="#10B981"
                        stroke-width="1.5"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                    </svg>
                  </div> -->
                </div>
              </div>
              <p class="opt-para-1 mb-0">
                ({{
                  applicantDashboardData?.totalCountryCountForApplicants
                    | number
                }}
                countries in total)
              </p>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-card-icon">
              <svg
                width="43"
                height="40"
                viewBox="0 0 43 40"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <ellipse
                  cx="21.5096"
                  cy="20"
                  rx="20.6496"
                  ry="20"
                  fill="#C3D2FE"
                />
                <ellipse
                  cx="21.5093"
                  cy="20"
                  rx="16.5197"
                  ry="16"
                  fill="#0235CD"
                />
                <g clip-path="url(#clip0_3446_103168)">
                  <path
                    d="M17.1822 13.627V11H17.1817L14.4699 13.6264V13.627H17.1822Z"
                    fill="white"
                  />
                  <path
                    d="M17.3279 19.3555H19.808V23.9024H17.3279V19.3555Z"
                    fill="white"
                  />
                  <path
                    d="M18.914 11C18.559 11 18.2711 11.2878 18.2711 11.6429V14.0388C18.2711 14.3939 17.9833 14.6817 17.6283 14.6817H15.1128C14.7578 14.6817 14.4699 14.9695 14.4699 15.3245V28.3571C14.4699 28.7122 14.7578 29 15.1128 29H27.9055C28.2606 29 28.5484 28.7122 28.5484 28.3571V11.6429C28.5484 11.2878 28.2606 11 27.9055 11H18.914ZM20.8969 24.3152C20.8969 24.6702 20.6091 24.958 20.2541 24.958H16.8818C16.5267 24.958 16.2389 24.6702 16.2389 24.3152V18.9446C16.2389 18.5895 16.5267 18.3017 16.8818 18.3017H20.2541C20.6091 18.3017 20.8969 18.5895 20.8969 18.9446V24.3152ZM26.8133 24.4307C26.8133 24.722 26.5772 24.958 26.2859 24.958H22.6149C22.3236 24.958 22.0875 24.722 22.0875 24.4307C22.0875 24.1395 22.3236 23.9034 22.6149 23.9034H26.2859C26.5772 23.9034 26.8133 24.1395 26.8133 24.4307ZM26.8133 22.1901C26.8133 22.4813 26.5772 22.7174 26.2859 22.7174H22.6149C22.3236 22.7174 22.0875 22.4813 22.0875 22.1901C22.0875 21.8988 22.3236 21.6627 22.6149 21.6627H26.2859C26.5772 21.6627 26.8133 21.8988 26.8133 22.1901ZM26.8133 19.9494C26.8133 20.2407 26.5772 20.4768 26.2859 20.4768H22.6149C22.3236 20.4768 22.0875 20.2407 22.0875 19.9494C22.0875 19.6582 22.3236 19.4221 22.6149 19.4221H26.2859C26.5772 19.4221 26.8133 19.6582 26.8133 19.9494Z"
                    fill="white"
                  />
                </g>
                <defs>
                  <clipPath id="clip0_3446_103168">
                    <rect
                      width="18.5846"
                      height="18"
                      fill="white"
                      transform="translate(12.2169 11)"
                    />
                  </clipPath>
                </defs>
              </svg>
            </div>
            <div class="stat-card-content">
              <p class="opt-para-1">Amount in Quotes</p>

              <div class="d-flex mb-2 align-items-center">
                <h4 class="opt-heading-4 fw-700 mb-0 me-3">
                  ${{ applicantDashboardData?.applicationQuotesValue | number }}
                </h4>
                <div>
                  <!-- <div class="d-flex align-items-center country-percent">
                    <p class="opt-footer fw-600 me-1 mb-0">+2%</p>
                    <svg
                      width="11"
                      height="8"
                      viewBox="0 0 11 8"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M10 1.5L5.8 5.7L4.2 3.3L1 6.5"
                        stroke="#10B981"
                        stroke-width="1.5"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                    </svg>
                  </div> -->
                </div>
              </div>
              <p class="opt-para-1 mb-0">
                ({{ applicantDashboardData?.applicationQuotesCount | number }}
                invoices in total)
              </p>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-card-icon">
              <svg
                width="43"
                height="40"
                viewBox="0 0 43 40"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <ellipse
                  cx="21.5096"
                  cy="20"
                  rx="20.6496"
                  ry="20"
                  fill="#C3D2FE"
                />
                <ellipse
                  cx="21.5093"
                  cy="20"
                  rx="16.5197"
                  ry="16"
                  fill="#0235CD"
                />
                <g clip-path="url(#clip0_3446_103168)">
                  <path
                    d="M17.1822 13.627V11H17.1817L14.4699 13.6264V13.627H17.1822Z"
                    fill="white"
                  />
                  <path
                    d="M17.3279 19.3555H19.808V23.9024H17.3279V19.3555Z"
                    fill="white"
                  />
                  <path
                    d="M18.914 11C18.559 11 18.2711 11.2878 18.2711 11.6429V14.0388C18.2711 14.3939 17.9833 14.6817 17.6283 14.6817H15.1128C14.7578 14.6817 14.4699 14.9695 14.4699 15.3245V28.3571C14.4699 28.7122 14.7578 29 15.1128 29H27.9055C28.2606 29 28.5484 28.7122 28.5484 28.3571V11.6429C28.5484 11.2878 28.2606 11 27.9055 11H18.914ZM20.8969 24.3152C20.8969 24.6702 20.6091 24.958 20.2541 24.958H16.8818C16.5267 24.958 16.2389 24.6702 16.2389 24.3152V18.9446C16.2389 18.5895 16.5267 18.3017 16.8818 18.3017H20.2541C20.6091 18.3017 20.8969 18.5895 20.8969 18.9446V24.3152ZM26.8133 24.4307C26.8133 24.722 26.5772 24.958 26.2859 24.958H22.6149C22.3236 24.958 22.0875 24.722 22.0875 24.4307C22.0875 24.1395 22.3236 23.9034 22.6149 23.9034H26.2859C26.5772 23.9034 26.8133 24.1395 26.8133 24.4307ZM26.8133 22.1901C26.8133 22.4813 26.5772 22.7174 26.2859 22.7174H22.6149C22.3236 22.7174 22.0875 22.4813 22.0875 22.1901C22.0875 21.8988 22.3236 21.6627 22.6149 21.6627H26.2859C26.5772 21.6627 26.8133 21.8988 26.8133 22.1901ZM26.8133 19.9494C26.8133 20.2407 26.5772 20.4768 26.2859 20.4768H22.6149C22.3236 20.4768 22.0875 20.2407 22.0875 19.9494C22.0875 19.6582 22.3236 19.4221 22.6149 19.4221H26.2859C26.5772 19.4221 26.8133 19.6582 26.8133 19.9494Z"
                    fill="white"
                  />
                </g>
                <defs>
                  <clipPath id="clip0_3446_103168">
                    <rect
                      width="18.5846"
                      height="18"
                      fill="white"
                      transform="translate(12.2169 11)"
                    />
                  </clipPath>
                </defs>
              </svg>
            </div>
            <div class="stat-card-content">
              <p class="opt-para-1">Amount in Payments</p>

              <div class="d-flex mb-2 align-items-center">
                <h4 class="opt-heading-4 fw-700 mb-0 me-3">
                  ${{ applicantDashboardData?.paymentValue | number }}
                </h4>
                <!-- <div>
                  <div class="d-flex align-items-center country-percent">
                    <p class="opt-footer fw-600 me-1 mb-0">+2%</p>
                    <svg
                      width="11"
                      height="8"
                      viewBox="0 0 11 8"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M10 1.5L5.8 5.7L4.2 3.3L1 6.5"
                        stroke="#10B981"
                        stroke-width="1.5"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                    </svg>
                  </div>
                </div> -->
              </div>
              <p class="opt-para-1 mb-0">
                ({{ applicantDashboardData?.paymentCount | number }} payments in
                total)
              </p>
            </div>
          </div>
        </div>

        <div class="line-chart-cards">
          <div class="d-flex justify-content-between mb-4">
            <h6 class="opt-heading-6 fw-700 mb-0 text-capitalize">
              {{ selectedChart }}
            </h6>
            <div class="applicant-invoice-payment">
              <a
                class="opt-para-1 fw-600 mb-0"
                [class]="selectedChart === 'applicant' ? 'chart-active' : ''"
                (click)="selectedChart = 'applicant'"
                >Applicants</a
              >
              <a
                class="opt-para-1 fw-600 mb-0"
                [class]="selectedChart === 'quote' ? 'chart-active' : ''"
                (click)="selectedChart = 'quote'"
                >Quote</a
              >
              <a
                class="opt-para-1 fw-600 mb-0"
                [class]="selectedChart === 'invoice' ? 'chart-active' : ''"
                (click)="selectedChart = 'invoice'"
                >Invoices</a
              >
              <a
                class="opt-para-1 fw-600 mb-0"
                [class]="selectedChart === 'payment' ? 'chart-active' : ''"
                (click)="selectedChart = 'payment'"
                >Payments</a
              >
            </div>
          </div>
          <div id="line-chart">
            <apx-chart
              [series]="
                selectedChart === 'applicant'
                  ? chartOptions.series
                  : chartOptions.series2
              "
              [chart]="chartOptions.chart"
              [xaxis]="chartOptions.xaxis"
              [stroke]="chartOptions.stroke"
              [colors]="chartOptions.colors"
              [dataLabels]="chartOptions.dataLabels"
              [legend]="chartOptions.legend"
              [markers]="chartOptions.markers"
              [grid]="chartOptions.grid"
              [yaxis]="chartOptions.yaxis"
              [title]="chartOptions.title"
            ></apx-chart>
          </div>
        </div>
      </div>
      <div class="grid_two">
        <div class="top-applicants">
          <div class="d-flex justify-content-between mb-4 mx-4">
            <h6 class="opt-heading-6 fw-700 mb-0">Top Applicants</h6>
            <!-- (click)="goToSeeAllApplicantPage(topApplicantList[0])" -->
            <a
              (click)="goToSeeAllApplicantPage()"
              class="opt-para-1 fw-600 mb-0"
              >See all</a
            >
          </div>

          <div class="text-content-container">
            <div
              class="text-content"
              *ngFor="let applicant of topApplicantList"
              (click)="goToSignleApplicantPage(applicant)"
            >
              <div class="icon-text">
                <div class="circle-abbreviate">
                  <p class="fw-400 opt-footer">
                    {{ applicant?.applicant?.firstName[0] }}
                    {{ applicant?.applicant?.lastName[0] }}
                  </p>
                </div>
                <div>
                  <p class="opt-para-1 fw-600 mb-0">
                    {{ applicant?.applicant?.name }}
                  </p>
                  <p class="opt-caption mb-0">
                    {{ applicant?.applicant?.email }}
                  </p>
                </div>
              </div>
              <div class="quote-text">
                <p class="opt-caption mb-0">
                  {{ applicant?.quoteCount }} Quotes
                </p>
                <div><img src="/assets/icons/arrow-greater.svg" alt="" /></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="wrapper_grid">
      <div class="border-container">
        <div class="d-flex justify-content-between mb-4">
          <h6 class="opt-heading-6 fw-700 mb-0">Top 5 Countries</h6>
          <!-- <a href="javascript:void(0)" class="opt-para-1 fw-600 mb-0">See all</a> -->
        </div>

        <div class="progress-bar-container">
          <div
            class="progress-barr"
            *ngFor="let country of topCountryByApplicantList"
          >
            <div class="img">
              <img
                class="flag-img pt-2"
                [src]="country?.country?.flagUrl"
                alt=""
              />
            </div>
            <div class="country-bar">
              <p class="opt-caption mb-0">{{ country?.country?.name }}</p>
              <div class="progresss">
                <mat-progress-bar
                  mode="determinate"
                  [value]="country.percentageValue"
                ></mat-progress-bar>
                <p class="opt-caption mb-0">{{ country.percentageValue }}%</p>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div
        class="border-container d-flex justify-content-center align-items-center"
      >
        <div class="guage-chart">
          <fusioncharts
            type="angulargauge"
            width="350"
            height="250"
            dataFormat="json"
            [dataSource]="guageDataSource"
          ></fusioncharts>
        </div>
      </div>

      <div class="border-container">
        <div class="dashboard_header">
          <h6 class="opt-heading-6 fw-600 chart-title-text">
            Applicants by Gender
          </h6>
        </div>
        <apx-chart
          [series]="dashboardDataPercentage"
          [colors]="donutChart.colors"
          [chart]="donutChart.chart"
          [labels]="donutChart.labels"
          [responsive]="donutChart.responsive"
          [plotOptions]="donutChart.plotOptions"
          [dataLabels]="donutChart.dataLabels"
          [legend]="donutChart.legend"
        ></apx-chart>
      </div>
    </div>

    <div class="wrapper_grid">
      <div class="border-container grid_two">
        <div class="table-responsive">
          <ng-container
            *ngIf="dataSource !== null && dataSource; else noTableData"
          >
            <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
              <ng-container matColumnDef="name">
                <th mat-header-cell *matHeaderCellDef>Applicant Name</th>
                <td mat-cell *matCellDef="let row">
                  {{ row?.applicant?.firstName }} {{ row?.applicant?.lastName }}
                </td>
              </ng-container>

              <!-- Name Column -->
              <ng-container matColumnDef="createdDate">
                <th mat-header-cell *matHeaderCellDef>Created Date</th>
                <td mat-cell *matCellDef="let row">
                  {{ row?.applicant?.createdDate | date }}
                </td>
              </ng-container>

              <!-- Weight Column -->
              <ng-container matColumnDef="createdBy">
                <th mat-header-cell *matHeaderCellDef>Created By</th>
                <td mat-cell *matCellDef="let row">
                  {{ row?.applicant?.createdBy }}
                </td>
              </ng-container>

              <!-- Symbol Column -->
              <ng-container matColumnDef="status">
                <th mat-header-cell *matHeaderCellDef>Status</th>
                <td mat-cell *matCellDef="let row">
                  <span
                    [ngClass]="{
                      'status-active': row?.applicant?.status === 1,
                      'status-inactive': row?.applicant?.status === 2
                    }"
                  >
                    {{ row?.applicant?.status === 1 ? 'Active' : 'Inactive' }}
                  </span>
                </td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
              <tr class="mat-row" *matNoDataRow>
                <td class="mat-cell" colspan="4">No matching data"</td>
              </tr>
            </table>
          </ng-container>
          <ng-template #noTableData>
            <app-table-loader></app-table-loader>
          </ng-template>
        </div>
      </div>
    </div>
  </div>
</section>
